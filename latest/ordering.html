

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Ordering method for sparse matrices &mdash; HSL.py: Harwell Subroutine Library wrappers in Python/Cython</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/julia.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="HSL.py: Harwell Subroutine Library wrappers in Python/Cython" href="index.html"/>
        <link rel="next" title="Scaling method for sparse matrices" href="scaling.html"/>
        <link rel="prev" title="Installation" href="installation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="contents.html" class="icon icon-home"> HSL.py
          

          
          </a>
          <h1>HSL.py</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul>
<li><a class="reference internal" href="#">Ordering method for sparse matrices</a><ul>
<li><a class="reference internal" href="#the-mc21-module">The <code class="docutils literal"><span class="pre">mc21</span></code> Module</a></li>
<li><a class="reference internal" href="#module-hsl.ordering.mc60">The <code class="docutils literal"><span class="pre">mc60</span></code> Module</a><ul>
<li><a class="reference internal" href="#sloan-s-algorithm">Sloan&#8217;s algorithm</a></li>
<li><a class="reference internal" href="#reverse-cuthill-mckee-algorithm">Reverse Cuthill-McKee algorithm</a></li>
<li><a class="reference internal" href="#example">Example</a><ul>
<li><a class="reference internal" href="#using-a-matrix-market-matrix-through-cysparse">Using a matrix market matrix through <strong class="program">CySparse</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">HSL.py</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="contents.html">Docs</a> &raquo;</li>
        
      <li>Ordering method for sparse matrices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/PythonOptimizers/HSL.py/blob/master/doc/source/ordering.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ordering-method-for-sparse-matrices">
<span id="ordering-page"></span><h1>Ordering method for sparse matrices<a class="headerlink" href="#ordering-method-for-sparse-matrices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-mc21-module">
<h2>The <code class="xref py py-mod docutils literal"><span class="pre">mc21</span></code> Module<a class="headerlink" href="#the-mc21-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-hsl.ordering.mc21"><span id="mc21-section"></span></span><p>A Python interface to the HSL subroutine MC21AD.</p>
<p><strong>References</strong></p>
<table class="docutils citation" frame="void" id="duff81a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Duff81a]</a></td><td>I. S. Duff, <em>On Algorithms for Obtaining a Maximum Transversal</em>,
ACM Trans. Math. Software, <strong>7</strong>, pp. 315-330, 1981.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="duff81b" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Duff81b]</a></td><td>I. S. Duff, <em>Algorithm 575: Permutations for a zero-free
diagonal</em>, ACM Trans. Math. Software, <strong>7</strong>, pp. 387-390, 1981.</td></tr>
</tbody>
</table>
<dl class="function">
<dt id="hsl.ordering.mc21.nonzerodiag">
<code class="descclassname">hsl.ordering.mc21.</code><code class="descname">nonzerodiag</code><span class="sig-paren">(</span><em>nrow</em>, <em>colind</em>, <em>rowptr</em><span class="sig-paren">)</span><a class="headerlink" href="#hsl.ordering.mc21.nonzerodiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the sparsity pattern of a square sparse matrix in compressed row
(csr) format, attempt to find a <em>row</em> permutation so the row-permuted
matrix has a nonzero diagonal, if this is possible. This function assumes
that the matrix indexing is 0-based. Note that in general, this function
does not preserve symmetry. The method used is a depth-first search with
lookahead described in <a class="reference internal" href="#duff81a" id="id1">[Duff81a]</a> and <a class="reference internal" href="#duff81b" id="id2">[Duff81b]</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">nrow:</th><td class="field-body">The number of rows of the input matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">colind:</th><td class="field-body">An integer array (or list) of length nnz giving the column
indices of the nonzero elements in each row.</td>
</tr>
<tr class="field-odd field"><th class="field-name">rowptr:</th><td class="field-body">An integer array (or list) of length nrow+1 giving the
indices of the first element of each row in colind.</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">perm:</th><td class="field-body">An integer array of length nrow giving the variable permutation.
If irow and jcol are two integer arrays describing the pattern of
the input matrix in triple format, perm[irow] and jcol
describe the permuted matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">nzdiag:</th><td class="field-body">The number of nonzeros on the diagonal of the permuted matrix.</td>
</tr>
</tbody>
</table>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-hsl.ordering.mc60">
<span id="the-mc60-module"></span><h2>The <code class="xref py py-mod docutils literal"><span class="pre">mc60</span></code> Module<a class="headerlink" href="#module-hsl.ordering.mc60" title="Permalink to this headline">¶</a></h2>
<p>A Python interface to the HSL subroutine MC60AD.</p>
<p>The functions in this module compute a symmetric permutation of a sparse
symmetric matrix so as to reduce its profile, wavefront, or bandwidth via
Sloan&#8217;s method <a class="reference internal" href="#slo" id="id3">[SLO]</a> or the reverse Cuthill-McKee method <a class="reference internal" href="#cm" id="id4">[CM]</a>.</p>
<p>References</p>
<table class="docutils citation" frame="void" id="cm" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[CM]</a></td><td>E. Cuthill and J. McKee, <em>Reducing the bandwidth of sparse symmetric
matrices</em> In Proc. 24th Nat. Conf. ACM, pages 157-172, 1969.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rs" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[RS]</td><td>J. K. Reid and J. A. Scott, <em>Ordering symmetric sparse matrices for
small profile and wavefront</em>, International Journal for Numerical
Methods in Engineering, <strong>45</strong>(12), pp. 1737&#8211;1755, 1999.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="slo" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[SLO]</a></td><td>S. W. Sloan, <em>An algorithm for profile and wavefront reduction of
sparse matrices</em>, International Journal of Numerical Methods in
Engineering, <strong>23</strong>, pp. 239&#8211;251, 1986.</td></tr>
</tbody>
</table>
<div class="section" id="sloan-s-algorithm">
<h3>Sloan&#8217;s algorithm<a class="headerlink" href="#sloan-s-algorithm" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="hsl.ordering.mc60.sloan">
<code class="descclassname">hsl.ordering.mc60.</code><code class="descname">sloan</code><span class="sig-paren">(</span><em>n, rowind, colptr, icntl=[0, 6], weight=[2, 1]</em><span class="sig-paren">)</span><a class="headerlink" href="#hsl.ordering.mc60.sloan" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply Sloan&#8217;s algorithm.</p>
<p>Sloan&#8217;s algorithm is used to reduce the profile and wavefront of a sparse
symmetric matrix. Either the lower or the upper triangle of the input
matrix should be given in compressed sparse column (csc) or compressed
sparse row (csr) format. This includes the diagonal of the matrix. A set of
weights can be supplied to define the priority function in Sloan&#8217;s method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">n:</th><td class="field-body">The order of the input matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">rowind:</th><td class="field-body">An integer array (or list) of length nnz giving the row
indices of the nonzero elements in each column.</td>
</tr>
<tr class="field-odd field"><th class="field-name">colptr:</th><td class="field-body">An integer array (or list) of length n+1 giving the indices of
the first element of each column in rowind.</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Note that since either triangle can be given in either csc or csr format,
the words &#8216;row&#8217; and &#8216;column&#8217; may be swapped in the description above.
The indexing in rowind and colptr should be zero-based.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Keywords:</th><td class="field-body"><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">icntl:</th><td class="field-body">An integer array (or list) of length two of control parameters
used during the first phase, where the input data is checked.
The method terminates if duplicates of out-of-range indices are
discovered (icntl[0]=0) or ignores them (icntl[0]=1). No
diagnostic messages will be output if icntl[1]=0. If icntl[1]
is &gt; 0, it gives the unit number (in the Fortran sense) where
diagonostic messages are output.</td>
</tr>
<tr class="field-even field"><th class="field-name">weight:</th><td class="field-body">An integer array (or list) of length two giving the weights
in Sloan&#8217;s priority function. Reid and Scott (1999) recommend
to apply the method twice, with either [2,1] and [16,1], or
with [1,2] and [16,1], and to retain the best result.</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">perm:</th><td class="field-body">An integer array of length n giving the variable permutation. If
irow and jcol are two integer arrays describing the pattern of
the input matrix in triple format, perm[irow] and perm[jrow]
describe the permuted matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">rinfo:</th><td class="field-body">A real array of length 4 giving statistics on the permuted
matrix.
rinfo[0] = profile
rinfo[1] = maximum wavefront
rinfo[2] = semi-bandwidth
rinfo[3] = root-mean-square wavefront.</td>
</tr>
</tbody>
</table>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="reverse-cuthill-mckee-algorithm">
<h3>Reverse Cuthill-McKee algorithm<a class="headerlink" href="#reverse-cuthill-mckee-algorithm" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="hsl.ordering.mc60.rcmk">
<code class="descclassname">hsl.ordering.mc60.</code><code class="descname">rcmk</code><span class="sig-paren">(</span><em>n, rowind, colptr, icntl=[0, 6]</em><span class="sig-paren">)</span><a class="headerlink" href="#hsl.ordering.mc60.rcmk" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the reverse Cuthill-McKee algorithm.</p>
<p>The reverse Cuthill-McKee algorithm is used to reduce the bandwidth of
a sparse symmetric matrix. Either the lower or the upper triangle of the
input matrix should be given in compressed sparse column (csc) or
compressed sparse row (csr) format. This includes the diagonal of the
matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">n:</th><td class="field-body">The order of the input matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">rowind:</th><td class="field-body">An integer array (or list) of length nnz giving the row
indices of the nonzero elements in each column.</td>
</tr>
<tr class="field-odd field"><th class="field-name">colptr:</th><td class="field-body">An integer array (or list) of length n+1 giving the indices of
the first element of each column in rowind.</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Note that since either triangle can be given in either csc or csr format,
the words &#8216;row&#8217; and &#8216;column&#8217; may be swapped in the description above.
The indexing in rowind and colptr should be zero-based.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Keywords:</th><td class="field-body"><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">icntl:</th><td class="field-body">An integer array (or list) of length two of control parameters
used during the first phase, where the input data is checked.
The method terminates if duplicates of out-of-range indices are
discovered (icntl[0]=0) or ignores them (icntl[0]=1). No
diagnostic messages will be output if icntl[1]=0. If icntl[1]
is &gt; 0, it gives the unit number (in the Fortran sense) where
diagonostic messages are output.</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">perm:</th><td class="field-body">An integer array of length n giving the variable permutation. If
irow and jcol are two integer arrays describing the pattern of
the input matrix in triple format, perm[irow] and perm[jcol]
describe the permuted matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">rinfo:</th><td class="field-body">A real array of length 4 giving statistics on the permuted
matrix.
rinfo[0] = profile
rinfo[1] = maximum wavefront
rinfo[2] = semi-bandwidth
rinfo[3] = root-mean-square wavefront.</td>
</tr>
</tbody>
</table>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;MC60 demo from the HSL MC60 spec sheet.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">hsl.ordering</span> <span class="k">import</span> <span class="n">_mc60</span>

<span class="n">icntl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>  <span class="c1"># Abort on error</span>
<span class="n">jcntl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>  <span class="c1"># Sloan&#39;s alg with auto choice</span>
<span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>                 <span class="c1"># Weights in Sloan&#39;s alg</span>

<span class="c1"># Store lower triangle of symmetric matrix in csr format (1-based)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">icptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>  <span class="c1"># nnz = 10</span>
<span class="n">irn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">icptr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">irn</span><span class="p">[:</span><span class="n">icptr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Check data</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">_mc60</span><span class="o">.</span><span class="n">mc60ad</span><span class="p">(</span><span class="n">irn</span><span class="p">,</span> <span class="n">icptr</span><span class="p">,</span> <span class="n">icntl</span><span class="p">)</span>

<span class="c1"># Compute supervariables</span>
<span class="n">nsup</span><span class="p">,</span> <span class="n">svar</span><span class="p">,</span> <span class="nb">vars</span> <span class="o">=</span> <span class="n">_mc60</span><span class="o">.</span><span class="n">mc60bd</span><span class="p">(</span><span class="n">irn</span><span class="p">,</span> <span class="n">icptr</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;The number of supervariables is &#39;</span><span class="p">,</span> <span class="n">nsup</span>

<span class="c1"># Permute reduced matrix</span>
<span class="n">permsv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">nsup</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">pair</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">nsup</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">_mc60</span><span class="o">.</span><span class="n">mc60cd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">irn</span><span class="p">,</span> <span class="n">icptr</span><span class="p">[:</span><span class="n">nsup</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="nb">vars</span><span class="p">[:</span><span class="n">nsup</span><span class="p">],</span> <span class="n">jcntl</span><span class="p">,</span> <span class="n">permsv</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span>

<span class="c1"># Compute profile and wavefront</span>
<span class="n">rinfo</span> <span class="o">=</span> <span class="n">_mc60</span><span class="o">.</span><span class="n">mc60fd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">irn</span><span class="p">,</span> <span class="n">icptr</span><span class="p">[:</span><span class="n">nsup</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">vars</span><span class="p">[:</span><span class="n">nsup</span><span class="p">],</span> <span class="n">permsv</span><span class="p">)</span>

<span class="c1"># Obtain variable permutation from supervariable permutation</span>
<span class="n">perm</span><span class="p">,</span> <span class="n">possv</span> <span class="o">=</span> <span class="n">_mc60</span><span class="o">.</span><span class="n">mc60dd</span><span class="p">(</span><span class="n">svar</span><span class="p">,</span> <span class="nb">vars</span><span class="p">[:</span><span class="n">nsup</span><span class="p">],</span> <span class="n">permsv</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;The variable permutation is &#39;</span><span class="p">,</span> <span class="n">perm</span>    <span class="c1"># 1-based</span>
<span class="nb">print</span> <span class="s1">&#39;The profile is &#39;</span><span class="p">,</span> <span class="n">rinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span> <span class="s1">&#39;The maximum wavefront is &#39;</span><span class="p">,</span> <span class="n">rinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span> <span class="s1">&#39;The semibandwidth is &#39;</span><span class="p">,</span> <span class="n">rinfo</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span> <span class="s1">&#39;The root-mean-square wavefront is &#39;</span><span class="p">,</span> <span class="n">rinfo</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-none"><div class="highlight"><pre><span></span>The number of supervariables is  4
The variable permutation is  [3 5 4 1 2]
The profile is  10.0
The maximum wavefront is  3.0
The semibandwidth is  3.0
The root-mean-square wavefront is  2.09761769634
</pre></div>
</div>
<div class="section" id="using-a-matrix-market-matrix-through-cysparse">
<h4>Using a matrix market matrix through <strong class="program">CySparse</strong><a class="headerlink" href="#using-a-matrix-market-matrix-through-cysparse" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hsl.ordering.mc60</span> <span class="k">import</span> <span class="n">sloan</span><span class="p">,</span> <span class="n">rcmk</span>
<span class="kn">from</span> <span class="nn">cysparse.sparse.ll_mat</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">cysparse.types.cysparse_types</span> <span class="k">as</span> <span class="nn">types</span>

<span class="kn">from</span> <span class="nn">hsl.tools.spy</span> <span class="k">import</span> <span class="n">fast_spy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">A</span> <span class="o">=</span> <span class="n">LLSparseMatrix</span><span class="p">(</span><span class="n">mm_filename</span><span class="o">=</span><span class="s1">&#39;bcsstk01.mtx&#39;</span><span class="p">,</span>
                   <span class="n">itype</span><span class="o">=</span><span class="n">types</span><span class="o">.</span><span class="n">INT32_T</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">types</span><span class="o">.</span><span class="n">FLOAT64_T</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
<span class="n">irow</span><span class="p">,</span> <span class="n">jcol</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>

<span class="n">A_csc</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">to_csc</span><span class="p">()</span>
<span class="n">colptr</span><span class="p">,</span> <span class="n">rowind</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">A_csc</span><span class="o">.</span><span class="n">get_numpy_arrays</span><span class="p">()</span>

<span class="n">perm1</span><span class="p">,</span> <span class="n">rinfo1</span> <span class="o">=</span> <span class="n">rcmk</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">rowind</span><span class="p">,</span> <span class="n">colptr</span><span class="p">)</span>   <span class="c1"># Reverse Cuthill-McKee</span>
<span class="n">perm2</span><span class="p">,</span> <span class="n">rinfo2</span> <span class="o">=</span> <span class="n">sloan</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">rowind</span><span class="p">,</span> <span class="n">colptr</span><span class="p">)</span>  <span class="c1"># Sloan&#39;s method</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">fast_spy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">irow</span><span class="p">,</span> <span class="n">jcol</span><span class="p">,</span> <span class="n">sym</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">left</span><span class="o">.</span><span class="n">get_axes</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>

<span class="c1"># Apply permutation 1 and plot reordered matrix</span>
<span class="n">middle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">fast_spy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">perm1</span><span class="p">[</span><span class="n">irow</span><span class="p">],</span> <span class="n">perm1</span><span class="p">[</span><span class="n">jcol</span><span class="p">],</span> <span class="n">sym</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">middle</span><span class="o">.</span><span class="n">get_axes</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rev. Cuthill-McKee (semibandwidth=</span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">rinfo1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Apply permutation 2 and plot reordered matrix</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">fast_spy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">perm2</span><span class="p">[</span><span class="n">irow</span><span class="p">],</span> <span class="n">perm2</span><span class="p">[</span><span class="n">jcol</span><span class="p">],</span> <span class="n">sym</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">right</span><span class="o">.</span><span class="n">get_axes</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sloan (semibandwidth=</span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">rinfo2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mc60_rcmk_sloan.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="id5">
<img alt="_images/mc60_rcmk_sloan.png" src="_images/mc60_rcmk_sloan.png" />
<p class="caption"><span class="caption-text">The sparsity pattern of the orginal matrix is shown on the left plot.
The middle and right plots show the same matrix after a symmetric permutation of the rows and columns
aiming to reduce the bandwidth, profile and/or wavefront. This is done respectively via the
reverse Cuthill-McKee method and the algorithm of Sloan.</span></p>
</div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scaling.html" class="btn btn-neutral float-right" title="Scaling method for sparse matrices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Sylvain Arreckx, Dominique Orban and Nikolaj van Omme.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0-dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>